var Sketch=function(){"use strict";function t(t){return"[object Array]"==Object.prototype.toString.call(t)}function e(t){return"function"==typeof t}function n(t){return"number"==typeof t}function i(t){return"string"==typeof t}function o(t){return w[t]||String.fromCharCode(t)}function a(t,e,n){for(var i in e)(n||!t.hasOwnProperty(i))&&(t[i]=e[i]);return t}function s(t,e){return function(){t.apply(e,arguments)}}function r(t){var n={};for(var i in t)n[i]=e(t[i])?s(t[i],t):t[i];return n}function l(t){function n(n){e(n)&&n.apply(t,[].splice.call(arguments,1))}function s(t){for(F=0;F<V.length;F++)z=V[F],i(z)?P[(t?"add":"remove")+"EventListener"].call(P,z,N,!1):e(z)?N=z:P=z}function l(){k(I),I=B(l),H||(n(t.setup),H=e(t.setup),n(t.resize)),t.running&&!q&&(t.dt=(O=+new Date)-t.now,t.millis+=t.dt,t.now=O,n(t.update),t.autoclear&&J&&t.clear(),n(t.draw)),q=++q%t.interval}function u(){P=Y?t.style:t.canvas,D=Y?"px":"",t.fullscreen&&(t.height=v.innerHeight,t.width=v.innerWidth),P.height=t.height+D,P.width=t.width+D,t.retina&&J&&Q&&(P.height=t.height*Q,P.width=t.width*Q,P.style.height=t.height+"px",P.style.width=t.width+"px",t.scale(Q,Q)),H&&n(t.resize)}function c(t,e){return X=e.getBoundingClientRect(),t.x=t.pageX-X.left-v.scrollX,t.y=t.pageY-X.top-v.scrollY,t}function h(e,n){return c(e,t.element),n=n||{},n.ox=n.x||e.x,n.oy=n.y||e.y,n.x=e.x,n.y=e.y,n.dx=n.x-n.ox,n.dy=n.y-n.oy,n}function d(t){if(t.preventDefault(),L=r(t),L.originalEvent=t,L.touches)for(G.length=L.touches.length,F=0;F<L.touches.length;F++)G[F]=h(L.touches[F],G[F]);else G.length=0,G[0]=h(L,K);return a(K,G[0],!0),L}function p(e){for(e=d(e),j=(U=V.indexOf(R=e.type))-1,t.dragging=/down|start/.test(R)?!0:/up|end/.test(R)?!1:t.dragging;j;)i(V[j])?n(t[V[j--]],e):i(V[U])?n(t[V[U++]],e):j=0}function f(e){_=e.keyCode,W="keyup"==e.type,Z[_]=Z[o(_)]=!W,n(t[e.type],e)}function x(e){t.autopause&&("blur"==e.type?b:C)(),n(t[e.type],e)}function C(){t.now=+new Date,t.running=!0}function b(){t.running=!1}function E(){(t.running?b:C)()}function S(){J&&t.clearRect(0,0,t.width,t.height)}function M(){T=t.element.parentNode,F=A.indexOf(t),T&&T.removeChild(t.element),~F&&A.splice(F,1),s(!1),b()}var I,N,P,T,X,F,D,O,z,L,R,_,W,j,U,q=0,G=[],H=!1,Q=v.devicePixelRatio,Y=t.type==m,J=t.type==y,K={x:0,y:0,ox:0,oy:0,dx:0,dy:0},V=[t.element,p,"mousedown","touchstart",p,"mousemove","touchmove",p,"mouseup","touchend",p,"click",g,f,"keydown","keyup",v,x,"focus","blur",u,"resize"],Z={};for(_ in w)Z[w[_]]=!1;return a(t,{touches:G,mouse:K,keys:Z,dragging:!1,running:!1,millis:0,now:0/0,dt:0/0,destroy:M,toggle:E,clear:S,start:C,stop:b}),A.push(t),t.autostart&&C(),s(!0),u(),l(),t}for(var u,c,h="E LN10 LN2 LOG2E LOG10E PI SQRT1_2 SQRT2 abs acos asin atan ceil cos exp floor log round sin sqrt tan atan2 pow max min".split(" "),d="__hasSketch",p=Math,y="canvas",f="webgl",m="dom",g=document,v=window,A=[],x={fullscreen:!0,autostart:!0,autoclear:!0,autopause:!0,container:g.body,interval:1,globals:!0,retina:!1,type:y},w={8:"BACKSPACE",9:"TAB",13:"ENTER",16:"SHIFT",27:"ESCAPE",32:"SPACE",37:"LEFT",38:"UP",39:"RIGHT",40:"DOWN"},C={CANVAS:y,WEB_GL:f,WEBGL:f,DOM:m,instances:A,install:function(e){if(!e[d]){for(var i=0;i<h.length;i++)e[h[i]]=p[h[i]];a(e,{TWO_PI:2*p.PI,HALF_PI:p.PI/2,QUATER_PI:p.PI/4,random:function(e,i){return t(e)?e[~~(p.random()*e.length)]:(n(i)||(i=e||1,e=0),e+p.random()*(i-e))},lerp:function(t,e,n){return t+n*(e-t)},map:function(t,e,n,i,o){return(t-e)/(n-e)*(o-i)+i}}),e[d]=!0}},create:function(t){return t=a(t||{},x),t.globals&&C.install(self),u=t.element=t.element||g.createElement(t.type===m?"div":"canvas"),c=t.context=t.context||function(){switch(t.type){case y:return u.getContext("2d",t);case f:return u.getContext("webgl",t)||u.getContext("experimental-webgl",t);case m:return u.canvas=u}}(),t.container.appendChild(u),C.augment(c,t)},augment:function(t,e){return e=a(e||{},x),e.element=t.canvas||t,e.element.className+=" sketch",a(t,e,!0),l(t)}},b=["ms","moz","webkit","o"],E=self,S=0,M="AnimationFrame",I="request"+M,N="cancel"+M,B=E[I],k=E[N],P=0;P<b.length&&!B;P++)B=E[b[P]+"Request"+M],k=E[b[P]+"Cancel"+I];return E[I]=B=B||function(t){var e=+new Date,n=p.max(0,16-(e-S)),i=setTimeout(function(){t(e+n)},n);return S=e+n,i},E[N]=k=k||function(t){clearTimeout(t)},C}();(function(){var t,e,n,i,o,a,s,r,l,u,c,h;a=150,o=128,u=.5,i="http://rvpg.me/experiments/dream/dream.mp3",r={MIN:5,MAX:80},c={MIN:.2,MAX:1},t={MIN:.8,MAX:.9},h={MIN:.001,MAX:.005},l={MIN:.5,MAX:1.25},n=["#69D2E7","#1B676B","#BEF202","#EBE54D","#00CDAC","#1693A5","#F9D423","#FF4E50","#E7204E","#0CCABA","#FF006F"],e=function(){function t(e,n,i){var o,a=this;this.audio=null!=e?e:new Audio,this.numBands=null!=n?n:256,this.smoothing=null!=i?i:.3,"string"==typeof this.audio&&(o=this.audio,this.audio=new Audio,this.audio.controls=!0,this.audio.src=o),this.context=new t.AudioContext,this.jsNode=this.context.createJavaScriptNode(2048,1,1),this.analyser=this.context.createAnalyser(),this.analyser.smoothingTimeConstant=this.smoothing,this.analyser.fftSize=2*this.numBands,this.bands=new Uint8Array(this.analyser.frequencyBinCount),this.audio.addEventListener("canplay",function(){return a.source=a.context.createMediaElementSource(a.audio),a.source.connect(a.analyser),a.analyser.connect(a.jsNode),a.jsNode.connect(a.context.destination),a.source.connect(a.context.destination),a.jsNode.onaudioprocess=function(){return a.analyser.getByteFrequencyData(a.bands),a.audio.paused?void 0:"function"==typeof a.onUpdate?a.onUpdate(a.bands):void 0}})}return t.AudioContext=self.AudioContext||self.webkitAudioContext,t.enabled=null!=t.AudioContext,t.prototype.start=function(){return this.audio.play()},t.prototype.stop=function(){return this.audio.pause()},t}(),s=function(){function e(t,e){this.x=null!=t?t:0,this.y=null!=e?e:0,this.reset()}return e.prototype.reset=function(){return this.level=1+floor(random(4)),this.scale=random(r.MIN,r.MAX),this.alpha=random(t.MIN,t.MAX),this.speed=random(c.MIN,c.MAX),this.color=random(n),this.size=random(l.MIN,l.MAX),this.spin=random(h.MAX,h.MAX),this.band=floor(random(o)),random()<.5&&(this.spin=-this.spin),this.smoothedScale=0,this.smoothedAlpha=0,this.decayScale=0,this.decayAlpha=0,this.rotation=random(TWO_PI),this.energy=0},e.prototype.move=function(){return this.rotation+=this.spin,this.y-=this.speed*this.level},e.prototype.draw=function(t){var e,n,i;return n=exp(this.energy),i=this.scale*n,e=this.alpha*this.energy*1.5,this.decayScale=max(this.decayScale,i),this.decayAlpha=max(this.decayAlpha,e),this.smoothedScale+=.3*(this.decayScale-this.smoothedScale),this.smoothedAlpha+=.3*(this.decayAlpha-this.smoothedAlpha),this.decayScale*=.985,this.decayAlpha*=.975,t.save(),t.beginPath(),t.translate(this.x+250*cos(this.rotation*this.speed),this.y),t.rotate(this.rotation),t.scale(this.smoothedScale*this.level,this.smoothedScale*this.level),t.moveTo(.5*this.size,0),t.lineTo(this.size*-.5,0),t.lineWidth=1,t.lineCap="round",t.globalAlpha=this.smoothedAlpha/this.level,t.strokeStyle=this.color,t.stroke(),t.restore()},e}(),Sketch.create({particles:[],setup:function(){var t,n,r,l,c,h,d,p,y,f,m=this;for(r=y=0,f=a-1;f>=y;r=y+=1)d=random(this.width),p=random(2*this.height),c=new s(d,p),c.energy=random(c.band/256),this.particles.push(c);if(!e.enabled)return h=document.getElementById("warning1"),h.style.display="block";try{if(t=new e(i,o,u),t.onUpdate=function(t){var e,n,i,o;for(i=m.particles,o=[],e=0,n=i.length;n>e;e++)c=i[e],o.push(c.energy=t[c.band]/256);return o},t.start(),document.body.appendChild(t.audio),l=document.getElementById("intro"),l.style.display="none",/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent))return h=document.getElementById("warning2"),h.style.display="block"}catch(g){n=g}},draw:function(){var t,e,n,i,o;for(this.globalCompositeOperation="lighter",i=this.particles,o=[],e=0,n=i.length;n>e;e++)t=i[e],t.y<-t.size*t.level*t.scale*2&&(t.reset(),t.x=random(this.width),t.y=this.height+t.size*t.scale*t.level),t.move(),o.push(t.draw(this));return o}})}).call(this);